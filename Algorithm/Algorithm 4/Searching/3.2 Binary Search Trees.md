# Binary Search Trees

这一章节介绍的二分搜索树在上一章无序 Symbol Table 的基础上，从一个链表演变成了二叉树，二叉树节点就是在链表节点上多了一个指针。

二分搜索树的特点就是左子树上的所有节点 key 都比根节点小，右子树上所有节点 key 都比根节点大，节点上维护一个 N，作为树的重量。

## Binary Search tree symbol table

```typescript
class TreeNode<Key, Value> {
  public key: Key;
  public val: Value;
  public N: number;
  public left: TreeNode<Key, Value>;
  public right: TreeNode<Key, Value>;

  constructor(key: Key, val: Value) {
    this.key = key;
    this.val = val;
    this.N = 1;
    this.left = null;
    this.right = null;
  }
}

class BST<Key, Value> {
  private root: TreeNode<Key, Value>;

  constructor() {
    this.root = null;
  }

  public size(x: TreeNode<Key, Value>) {
    return x == null ? 0 : x.N;
  }

  private _get(x: TreeNode<Key, Value>, key: Key) {
    if (x == null) {
      return null;
    }

    if (key < x.key) {
      return this._get(x.left, key);
    } else if (key > x.key) {
      return this._get(x.right, key);
    } else {
      return x.val;
    }
  }

  private _put(x: TreeNode<Key, Value>, key: Key, val: Value) {
    if (x == null) {
      return new TreeNode(key, val);
    }

    if (key < x.key) {
      x.left = this._put(x.left, key, val);
    } else if (key > x.key) {
      x.right = this._put(x.right, key, val);
    } else {
      x.val = val;
    }

    x.N = this.size(x.left) + this.size(x.right) + 1;
    return x;
  }

  public get(key: Key) {
    this._get(this.root, key);
  }

  public put(key: Key, val: Value) {
    this.root = this._put(this.root, key, val);
  }
}
```

\_get 递归函数定义，输入树的根节点和 key，找到这个树种对应的节点。

\_put 递归函数定义：输入一个节点作为根节点，同时输入想插入节点的 key & value， 更新输入根节点所在的树, 返回更新后的树。

这幅图能够让`_get`/`_put`有一个直观的认识，本质上就是二分查找，找到就返回/更新，没找到(null)就返回 null 或者新建一个树节点。

`successful` or `unsuccessful`

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/495fa1b0f4254a72aa6c9522e07752b8~tplv-k3u1fbpfcp-watermark.image?)

## Recursion

这里在 BST 提到了递归的动态理解，**递归函数调用之前的位置的代码，是从树自顶向下执行的。**比如在比较传入的 key 值和每个节点的 key 值，是自顶向下去比较的，只有这样才知道是往左走还是往右走。而在**递归函数调用之后的代码，是从树自顶向上执行的**，比如更新根节点的 size，必须得知道左右子树的 size 与自身相加，才能得到根节点的 size。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/588cadd651d44169bf5258755a5b3872~tplv-k3u1fbpfcp-watermark.image?)
